"use strict";(()=>{var e={};e.id=805,e.ids=[805],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7345:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>v,staticGenerationAsyncStorage:()=>y});var o={};r.r(o),r.d(o,{GET:()=>u,POST:()=>l,dynamic:()=>c});var i=r(921),s=r(7380),n=r(4185),a=r(3878),p=r(3524);let c="force-dynamic",d=new p.PrismaClient;async function u(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),o=parseInt(t.get("limit")||"10"),i=t.get("search")||"",s=t.get("location")||"",n=t.get("propertyType")||"",p=t.get("minPrice"),c=t.get("maxPrice"),u=t.get("bedrooms"),l=t.get("isForRent"),m=t.get("isForInvest"),g=(r-1)*o,y={};i&&(y.OR=[{title:{contains:i,mode:"insensitive"}},{city:{contains:i,mode:"insensitive"}},{description:{contains:i,mode:"insensitive"}}]),s&&(y.city={contains:s,mode:"insensitive"}),n&&(y.propertyType=n),p&&(y.price={...y.price,gte:parseFloat(p)}),c&&(y.price={...y.price,lte:parseFloat(c)}),u&&(y.bedrooms={gte:parseInt(u)}),"true"===l&&(y.isForRent=!0),"true"===m&&(y.isForInvest=!0);let[v,h]=await Promise.all([d.property.findMany({where:y,skip:g,take:o,orderBy:{createdAt:"desc"}}),d.property.count({where:y})]);return a.NextResponse.json({properties:v,pagination:{page:r,limit:o,total:h,pages:Math.ceil(h/o)}})}catch(e){return console.error("Error fetching properties:",e),a.NextResponse.json({error:"Failed to fetch properties"},{status:500})}}async function l(e){try{let t=await e.json(),r=await d.property.create({data:{title:t.title,description:t.description,address:t.address,city:t.city,state:t.state,zipCode:t.zipCode,price:t.price,bedrooms:t.bedrooms,bathrooms:t.bathrooms,sqft:t.sqft,propertyType:t.propertyType,imageUrl:t.imageUrl,images:t.images||[],tokenPrice:t.tokenPrice,totalTokens:t.totalTokens,availableTokens:t.availableTokens,expectedReturn:t.expectedReturn,isForRent:t.isForRent||!1,isForInvest:t.isForInvest||!1}});return a.NextResponse.json(r,{status:201})}catch(e){return console.error("Error creating property:",e),a.NextResponse.json({error:"Failed to create property"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/properties/route",pathname:"/api/properties",filename:"route",bundlePath:"app/api/properties/route"},resolvedPagePath:"/home/ubuntu/provena/app/app/api/properties/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:y,serverHooks:v}=m,h="/api/properties/route";function x(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:y})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[923,146],()=>r(7345));module.exports=o})();